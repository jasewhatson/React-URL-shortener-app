{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jase/src/the-station-url-shortener/url-shortener-react-js/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jase/src/the-station-url-shortener/url-shortener-react-js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jase/src/the-station-url-shortener/url-shortener-react-js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/*\nTODO: Logic to not submit duplicate URL's which are already in our DB\nTODO: Provide msg on success copy to clipboard to user & success URL shorten\nTODO: Remove use of !important in App.css - temp quick fix to resolve conflicts\n*/import'./App.css';import'./css/main.css';import{React,useState}from\"react\";import axios from\"axios\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Results=function Results(props){return/*#__PURE__*/_jsxs(\"div\",{className:\"errorMessage\",children:[\"Error: \",props.msg]});};function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),userInput=_useState2[0],setUserInput=_useState2[1];var savedLinks=JSON.parse(window.localStorage.getItem('users_short_links'));var _useState3=useState(savedLinks!==null&&savedLinks!==void 0?savedLinks:[]),_useState4=_slicedToArray(_useState3,2),shortenedLinks=_useState4[0],setShortenedLinks=_useState4[1];//https://usefulangle.com/post/281/javascript-default-value-if-null-or-undefined\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showError=_useState6[0],setShowError=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),showErrorMsg=_useState8[0],setShowErrorMsg=_useState8[1];var isValidHttpUrl=function isValidHttpUrl(string){var url;try{url=new URL(string);}catch(_){return false;}return url.protocol===\"http:\"||url.protocol===\"https:\";};var fetchShortURL=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,newLinkJSON,newShortenedLinks;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(userInput==\"\")){_context.next=7;break;}setShowError(true);setShowErrorMsg(\"No value provided\");console.log(\"No value provided\");return _context.abrupt(\"return\");case 7:if(!(isValidHttpUrl(userInput)==false)){_context.next=14;break;}setShowError(true);setShowErrorMsg(\"Invalid url provided\");console.log(\"Invalid url provided\");return _context.abrupt(\"return\");case 14:setShowError(false);setShowErrorMsg(\"\");case 16:_context.prev=16;_context.next=19;return axios(\"https://api.shrtco.de/v2/shorten?url=\".concat(userInput));case 19:response=_context.sent;newLinkJSON={\"orig_url\":userInput,\"short_url\":response.data.result.full_short_link,\"time_created\":Date.now()};newShortenedLinks=shortenedLinks.slice();//https://stackoverflow.com/questions/26505064/what-is-the-best-way-to-add-a-value-to-an-array-in-state\nnewShortenedLinks.push(newLinkJSON);window.localStorage.setItem('users_short_links',JSON.stringify(newShortenedLinks));setShortenedLinks(newShortenedLinks);//https://bobbyhadz.com/blog/react-map-array-reverse\n_context.next=32;break;case 27:_context.prev=27;_context.t0=_context[\"catch\"](16);setShowError(true);setShowErrorMsg(\"Error on api call - \"+_context.t0.toString());console.log(_context.t0);case 32:case\"end\":return _context.stop();}}},_callee,null,[[16,27]]);}));return function fetchShortURL(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"URL shortener app\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Original URL\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Short URL\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\xA0\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:shortenedLinks.map(function(link,index){return/*#__PURE__*/_jsxs(\"tr\",{id:link.time_created,children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:link.orig_url}),/*#__PURE__*/_jsx(\"td\",{children:link.short_url}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:function onClick(){navigator.clipboard.writeText(shortenedLinks[index].short_url);},children:\"Copy to clipboard\"})})]},link.time_created);})})]}),showError?/*#__PURE__*/_jsx(Results,{msg:showErrorMsg}):null,/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",placeholder:\"Enter link to be shortened\",value:userInput,onChange:function onChange(e){setUserInput(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-submit-url\",onClick:function onClick(){fetchShortURL();},children:\"Submit URL\"})})]});}export default App;","map":{"version":3,"names":["React","useState","axios","Results","props","msg","App","userInput","setUserInput","savedLinks","JSON","parse","window","localStorage","getItem","shortenedLinks","setShortenedLinks","showError","setShowError","showErrorMsg","setShowErrorMsg","isValidHttpUrl","string","url","URL","_","protocol","fetchShortURL","console","log","response","newLinkJSON","data","result","full_short_link","Date","now","newShortenedLinks","slice","push","setItem","stringify","toString","map","link","index","time_created","orig_url","short_url","navigator","clipboard","writeText","e","target","value"],"sources":["/Users/jase/src/the-station-url-shortener/url-shortener-react-js/src/App.js"],"sourcesContent":["/*\nTODO: Logic to not submit duplicate URL's which are already in our DB\nTODO: Provide msg on success copy to clipboard to user & success URL shorten\nTODO: Remove use of !important in App.css - temp quick fix to resolve conflicts\n*/\nimport './App.css';\nimport './css/main.css';\nimport { React, useState } from \"react\";\nimport axios from \"axios\";\n\nconst Results = (props) => (\n  <div className=\"errorMessage\">\n    Error: {props.msg}\n  </div>\n)\n\nfunction App() {\n\n  const [userInput, setUserInput] = useState(\"\");\n  var savedLinks = JSON.parse(window.localStorage.getItem('users_short_links'));\n  const [shortenedLinks, setShortenedLinks] = useState(savedLinks ?? []); //https://usefulangle.com/post/281/javascript-default-value-if-null-or-undefined\n  const [showError, setShowError] = useState(false);\n  const [showErrorMsg, setShowErrorMsg] = useState(\"\");\n\n  const isValidHttpUrl = (string) => {\n    let url;\n    try {\n      url = new URL(string);\n    } catch (_) {\n      return false;  \n    }\n    return url.protocol === \"http:\" || url.protocol === \"https:\";\n  }\n\n  const fetchShortURL = async () => {\n\n    if(userInput == \"\"){\n      setShowError(true);\n      setShowErrorMsg(\"No value provided\");\n      console.log(\"No value provided\");\n      return;\n    }else if(isValidHttpUrl(userInput) == false){\n      setShowError(true);\n      setShowErrorMsg(\"Invalid url provided\");\n      console.log(\"Invalid url provided\");\n      return;\n    }else{\n      setShowError(false);\n      setShowErrorMsg(\"\");\n    }\n\n    try {\n      const response = await axios(\n        `https://api.shrtco.de/v2/shorten?url=${userInput}`\n      );\n\n      var newLinkJSON = {\n        \"orig_url\": userInput,\n        \"short_url\": response.data.result.full_short_link,\n        \"time_created\": Date.now()\n      };\n\n      var newShortenedLinks = shortenedLinks.slice();   //https://stackoverflow.com/questions/26505064/what-is-the-best-way-to-add-a-value-to-an-array-in-state\n      newShortenedLinks.push(newLinkJSON);\n      window.localStorage.setItem('users_short_links', JSON.stringify(newShortenedLinks));\n      setShortenedLinks(newShortenedLinks); //https://bobbyhadz.com/blog/react-map-array-reverse\n\n    } catch (e) {\n      setShowError(true);\n      setShowErrorMsg(\"Error on api call - \" + e.toString());\n      console.log(e);\n    }\n  };\n\n  return (\n\n    <div>\n      <h1>URL shortener app</h1>\n      <br></br>\n      <table className=\"table table-striped\">\n        <thead>\n          <tr>\n            <th scope=\"col\">#</th>\n            <th scope=\"col\">Original URL</th>\n            <th scope=\"col\">Short URL</th>\n            <th scope=\"col\">&nbsp;</th>\n          </tr>\n        </thead>\n        <tbody>\n          {\n            shortenedLinks.map((link, index) => (\n              <tr key={link.time_created} id={link.time_created}>\n                <th scope=\"row\">{index + 1}</th>\n                <td>{link.orig_url}</td>\n                <td>{link.short_url}</td>\n                <td><button className=\"btn btn-primary\" onClick={() => { navigator.clipboard.writeText(shortenedLinks[index].short_url) }}>Copy to clipboard</button></td>\n              </tr>\n            ))}\n        </tbody>\n      </table>\n      { showError ? <Results msg={showErrorMsg}/> : null }           \n      <input\n        className=\"form-control\"\n        type=\"text\"\n        placeholder=\"Enter link to be shortened\"\n        value={userInput}\n        onChange={(e) => {\n          setUserInput(e.target.value);\n        }}\n      />\n      <div>\n        <button\n          className=\"btn btn-primary btn-submit-url\"\n          onClick={() => {\n            fetchShortURL();\n          }}\n        >\n          Submit URL\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}